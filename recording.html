<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="images/favicon.png" />

	<title>DARR NU DAARA</title>

    <link rel="stylesheet" href="css/fontawesome.min.css" />
    <link rel="stylesheet" href="css/main.min.css" />
    
</head>
<body>
<!-- main start -->
<main class="main">
 

    <!-- header start -->
    <header class="header">
        <div class="headerInsider">
            <a href="home.html"><img class="logo" src="images/logo.png" alt="logo" /></a>
            <aside class="menubar" id="menubar">
                <span></span><span></span><span></span>
            </aside>
            <div class="headerRight" id="menucontainer">
                <div class="headercontainer">
                    <ul>
                        <li class="head_menu">
                            <a href="#">
                                <img src="images/menu-icon1.png" alt="ABOUT" />
                                <span>ABOUT</span> 
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="head_menu">
                            <a href="participate-now.html">
                                <img src="images/menu-icon2.png" alt="PARTICIPATE" />
                                <span>PARTICIPATE NOW</span>
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="head_menu">
                            <a href="get-in-touch.html">
                                <img src="images/menu-icon3.png" alt="GET IN TOUCH" />
                                <span>GET IN TOUCH</span>
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="login_before">
                            <a href="login.html">
                                <img src="images/user-icon.png" alt="LOG IN" />
                                <span>LOG IN</span>
                            </a>
                        </li>
                        <li class="login_after">
                            <div class="login_after_head" id="login_after_head">
                                <img id="userprofilepicture" src="images/user-icon.png" alt="user" />
                                <span id="userprofilename">Yesh</span>
                            </div>
                            <div class="login_after_body" id="login_after_body">
                                <h3>
                                    <span>yashmathur@mail.com</span>
                                    <span>7838002120</span>
                                </h3>
                                <h4><a href="previous-entries.html">Previous Entries</a></h4>
                                <h5>
                                    <a href="/">
                                        <span>Log Out</span> 
                                        <img src="images/log-out.png" alt="log out" />
                                    </a>
                                </h5>
                            </div>
                        </li>
                    </ul>

                    <div class="header-bottom-mobile">
                        <p>
                            <a href="https://www.youtube.com/user/MountainDewIndia?app=desktop" target="_blank"><i class="fa fa-youtube-play" aria-hidden="true"></i></a>
                            <a href="https://www.facebook.com/mountaindewindia/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                            <a href="https://twitter.com/mountaindewin?lang=en" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                            <a href="https://www.instagram.com/mountaindewin/?hl=en" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                        </p>
                        <h2>Copyright &copy; 2023 Pepsico inc. all rights reserved.</h2>
                    </div>
                    
                </div>
            </div>
        </div>
    </header>
    <!-- header end -->




 




    <!-- recordingscreen start -->
    <section class="recordingscreenwrap bgwithout">
        <div class="recordingscreencontainer">
            
            <div class="recordingholder">
                    <i class="fa fa-angle-left" aria-hidden="true" onclick="window.open('home.html','_self')"></i>
                    <div class="recordingvideopart">    
                        <video id="video" autoplay="autoplay"></video>
                    </div>
                    <div class="recordingtextpart">
                        <p>ਤੁਸੀ ਕਿਵੇਂ ਹੋ ਵੈ ਜਾਨ ਵਾਲੇਯਾ ੲਨ੍ਜ ਛਡ ਕੇ ਨਾ ਜਾਵੀਂ ਕੀਤੇ ਵਅਦੇ ਸਾਰੇ ਓ ਤੋੜ ਨਿਭਾਵੀਂ ਗਲਾਂ ਇਸ਼੍ਕ਼ ਦਿ ਕਿਤੀਯਂ ਸਨ੍ਗ ਰਾਤਾਂ ਕਡੀਯਾਂ ਵੈ ਜਾਨ ਵਾਲੇਯਾ ੲਨ੍ਜ ਛਡ ਕੇ ਨਾ ਜਾਵੀਂ ਕੀਤੇ ਵਅਦੇ ਸਾਰੇ ਓ ਤੋੜ ਨਿਭਾਵੀਂ ਗਲਾਂ ਇਸ਼੍ਕ਼ ਦਿ ਕਿਤੀਯਂ ਸਨ੍ਗ ਰਾਤਾਂ ਕਡੀਯਾਂ ਵੈ ਜਾਨ ਵਾਲੇਯਾ ੲਨ੍ਜ ਛਡ ਕੇ ਨਾ ਜਾਵੀਂ ਕੀਤੇ ਵਅਦੇ ਸਾਰੇ ਓ ਤੋੜ ਨਿਭਾਵੀਂ ਗਲਾਂ ਇਸ਼੍ਕ਼ ਦਿ ਕਿਤੀਯਂ ਸਨ੍ਗ ਰਾਤਾਂ ਕਡੀਯਾ</p>
                    </div>
            </div>
            <div class="recordingcontrols">
                <audio id="audio" src="lib/audio/audiofile.mp3"></audio>
                <input type="button" id="audio-btn" value="Play Audio" onclick="PlayAudio();" />&nbsp;
                <input type="button" id="audio-btn2" value="Stop Audio" onclick="StopAudio();" />&nbsp;
                        



                        <input type="button" id="start-btn" value="Start Recording" />&nbsp;
                        <input type="button" id="stop-btn" value="Stop Recording" />&nbsp;
                        

            </div>

            <div class="recordingcontrols">
                        <a id="download-link" style="display: none;" target="_blank">Download</a>
                        &nbsp;
                        <a id="downloadffmpeg" style="display: none;" target="_blank">Download Recorded Video</a>
            </div>
            
        </div>
    </section>
    <!-- recordingscreen end -->
    


 
    
    <!-- select song bottom start -->
    <div class="selectsongbottom">
        <section>
            <ul>
                <li class="active"><span>Part 1</span></li>
                <li><span>Part 2</span></li>
                <li><span>Part 3</span></li>
                <li><span>Part 4</span></li>
            </ul>
            <!-- 
            <p>Select a part to proceed</p>
            <aside>
                <span class="ssbtn_resume">Resume</span>
                <span class="ssbtn_next disabaled">Next</span>
            </aside>
            -->
        </section>
    </div>
    <!-- select song  start -->
    

</main>
<!-- main end -->





<!-- loader === start -->
<div id="pageloader" class="pageloader">
    <div><i class="fa fa-spinner fa-spin"></i></div>
</div>
<!-- loader === end -->






  
<script src="scripts/jquery-min.js"></script>
<script src="scripts/common.js"></script>
<script src="scripts/jquery-ui.js"></script>

<script>
    const audioElement = document.querySelector('audio');
    const videoElement = document.querySelector('video');
    const startBtn = document.querySelector('#start-btn');
    const stopBtn = document.querySelector('#stop-btn');
    const downloadLink = document.querySelector('#download-link');
    const downloadRecordVideoLink = document.querySelector('#downloadffmpeg');

    ValidateForMediaRecorder();

    function ValidateForMediaRecorder() {
        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            console.log("MediaRecorder API is supported");
            AccessUserCameraAndMicroPhone();
        } else {
            console.error("MediaRecorder API is not supported");
        }
    }

    function AccessUserCameraAndMicroPhone() {

        navigator.mediaDevices.getUserMedia({
            video: true,
            audio: false
        }).then(function (stream) {
            videoElement.srcObject = stream;
            var mediaRecorder = new MediaRecorder(stream);
            var chunks = [];

            mediaRecorder.addEventListener("dataavailable", function (event) {
                chunks.push(event.data);
                var videoBlob = event.data;
                var reader = new FileReader();
                reader.onloadend = function () {
                    var base64Video = reader.result;
                    sendVideoToServer(base64Video);
                };
                reader.readAsDataURL(videoBlob);
            });

            mediaRecorder.addEventListener("stop", function () {
                debugger;
                var blob = new Blob(chunks, { type: "video/mp4" });
                const url = URL.createObjectURL(blob);
                downloadLink.href = url;
                //downloadLink.download = 'recorded-video.mp4';
                chunks = [];
            });

            startBtn.addEventListener('click', function () {
                mediaRecorder.start();
                startBtn.setAttribute('disabled', true);
                stopBtn.removeAttribute('disabled');
            });

            stopBtn.addEventListener('click', function () {
                mediaRecorder.stop();
                stopBtn.setAttribute('disabled', true);
                downloadLink.style.display = 'block';
                var audio = document.getElementById("audio");
                audio.pause();
                audio.currentTime = 0;
            });

        });

    }

    function sendVideoToServer(base64Video) {
        debugger;
        var data = JSON.stringify({ videoData: base64Video });
        PageMethods.SaveVideo(base64Video, onSucceed, onerror);
    }

    function onerror() {
    }

    function onSucceed(ds) {
        console.log(ds);
        var _val = ds.split(',');
        downloadRecordVideoLink.style.display = 'block';
        downloadRecordVideoLink.href = "lib/output/" + _val[1];
        downloadLink.href = "lib/video/" + _val[1];
        alert(_val[0]);
        console.log(_val[2]);
    }

    function PlayAudio() {
        var audio = document.getElementById("audio");
        audio.play();
        startBtn.removeAttribute('disabled');
        stopBtn.removeAttribute('disabled');
    }

    function StopAudio() {
        var audio = document.getElementById("audio");
        audio.pause();
    }

</script>
</body>
</html>
 